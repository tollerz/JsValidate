!function(e,t,i,n){function r(t,i){return this.$form=e(t),this.options=e.extend({},o,i),this._defaults=o,this._name=a,this}var a="validate",o={rules:{},verification:{},debug:!1,onchange:!0,valid:!1,onsubmit:!0,highlight:!0,onchangeElements:["select","checkbox","file","textarea"],onkeyupElements:["text","textarea"],errorList:[],passList:[],errorMessage:e("<span class='validation-error' id='message'></span>")};r.prototype={validation:function(){this.options.errorList=[],this.checkAll(this.options.rules,"rules"),this.checkAll(this.options.verification,"verification")},checkAll:function(t){var i=this.$form,n=this;e.each(t,function(t){var t=e(i.find("#"+t));n.checkValidity(t)})},checkValidity:function(t){var i=this,r=i.elementValue(t);e.each(t.data("rules"),function(e){t.data("rules")[e].valid=i.validateCheck(e,r,t)}),t.data("verification")!==n&&e.each(t.data("verification"),function(){i.verifyCheck(r,t,i)}),i.updateErrorList(t,"rules"),i.displayErrors(t,"rules")},validateCheck:function(e,t,i){var n=this.options.rules[i.prop("id")][e];return this.validate[e](t,i,n)},verifyCheck:function(e,t,i){var n=t.data("verification").ajax.url+e;return""===e?!1:this.verify.ajax.initiate(t,n,i)},updateErrorList:function(t,i){var n=this,r=this.options.errorList,a=t.prop("id");n.removeError(a,r),e.each(t.data(i),function(e){t.data(i)[e].valid||n.addError(a,r)})},addError:function(e,t){-1===t.indexOf(e)&&t.push(e)},removeError:function(e,t){var i=t.indexOf(e);i>0&&t.splice(i,1)},displayErrors:function(t,i){var n=this,r=t.prop("id"),a=!1,o=t;"select"===e(t).prop("tagName").toLowerCase()&&t.prev("div").hasClass("select2-container")&&(o=e(t.prev("div"))),n.reset(o),e.inArray(r,this.options.errorList)>=0&&e.each(t.data(i),function(e,t){if(!t.valid&&!a){var i=n.options.errorMessage;o.parent().append(i.append(t.message)),n.options.highlight&&o.css("border","2px solid #b94a48"),a=!0}})},reset:function(t){t.parent().find("#message").remove(),this.options.errorMessage=e('<span class="validation-error" id="message"></span>'),t.attr("style","")},formValid:function(){return 0===this.options.errorList.length},setuprules:function(){var t=this;e.each(this.options.rules,function(i,n){var r=t.$form,a=e(r.find("#"+i)),o=t.inputtype(a);return t.validinputtype(a)?(a.data("rules",t.setrules(n)),void t.seteventhandler(a,o)):(console.error('Element with id "'+i+'" is a <'+o+"> and not a valid form element."),void t.removeRule(a.prop("id")))}),e.each(this.options.verification,function(i,n){var r=t.$form,a=e(r.find("#"+i)),o=t.inputtype(a);return t.validinputtype(a)?(a.data("verification",t.setVerification(n)),void t.seteventhandler(a,o)):(console.error('Element with id "'+i+'" is a <'+o+"> and not a valid form element."),void t.removeRule(a.prop("id")))}),this.options.onsubmit===!0&&t.seteventhandler(this.$form,"submit")},setrules:function(t){var i={};return e.each(t,function(e,t){i[e]={message:t,valid:!1}}),i},setVerification:function(t){var i={};return e.each(t,function(e,t){i[e]={message:t[0],url:t[1],valid:!1,inprogress:!1}}),i},defineCustomFunction:function(e){return"function"==typeof e?e:function(){return!1}},removeRule:function(e){delete this.options.rules[e]},seteventhandler:function(t,i){var n=this;this.options.onchange&&(-1!==e.inArray(i,this.options.onchangeElements)&&t.on("change",function(){n.onchange(t)}),-1!==e.inArray(i,this.options.onkeyupElements)&&t.on("keyup blur",function(){n.onkeyup(t)})),"submit"===i&&t.on("submit",function(e){n.onsubmit(e,t)})},onsubmit:function(e){return this.options.debug&&e.preventDefault(),this.validation(),this.formValid()?void 0:(e.preventDefault(),!1)},onkeyup:function(e){this.checkValidity(e)},onchange:function(e){this.checkValidity(e)},validinputtype:function(e){return e.is("select, input, textarea, file, text")},inputtype:function(t){var i="";return i=e(t).prop("tagName").toLowerCase(),"input"===i?e(t).prop("type"):i},elementValue:function(t){var i,n=e(t),r=t.type;return"radio"===r||"checkbox"===r?e('input[name="'+t.name+'"]:checked').val():(i=n.val(),"string"==typeof i?i.replace(/\r/g,""):i)},validate:{required:function(t){return e.trim(t).length>0},number:function(e){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)},email:function(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},noSymbols:function(e){return/^[A-Za-z0-9 _]*[A-Za-z0-9][A-Za-z0-9 _]*$/.test(e)},maxLength:function(e,t,i){return t.data("rules").maxLength.message="must be no more than "+i+" characters long, currently "+e.length,e.length<=i},minLength:function(e,t,i){return t.data("rules").minLength.message="must be no less than "+i+" characters long, currently "+e.length,e.length>=i},rangeLength:function(e,t,i){return t.data("rules").rangeLength.message="must be between "+i[0]+" and "+i[1]+" characters long, currently "+e.length,e.length>=i[0]&&e.length<=i[1]}},verify:{ajax:{ajaxRequest:null,requestTime:null,initiate:function(e,t,i){null!==this.ajaxRequest&&this.ajaxRequest.abort(),clearTimeout(this.requestTimer),e.data("verification").ajax.inprogress=!0,this.requestTimer=setTimeout(this.request(t),350),this.response(e,i)},request:function(t){this.ajaxRequest=e.ajax({type:"GET",url:t})},response:function(t,i){this.ajaxRequest.done(function(n){var r=e.parseJSON(n);valid="true"===r||r===!0,t.data("verification").ajax.valid=valid,i.updateErrorList(t,"verification"),i.displayErrors(t,"verification"),t.data("verification").ajax.inprogress=!1})}}}},e.fn[a]=function(t){return this.each(function(){if(!e.data(this,"validate"))var i=e.data(this,"validate",new r(this,t));i.setuprules()})}}(jQuery,window,document);